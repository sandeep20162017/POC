function getAutoCompleteParams() {
    // 1. Get the grid instance safely
    var grid = $("#NscPartsUsedGrid").data("kendoGrid");
    if (!grid) {
        console.warn("Grid not found");
        return { columnName: "", searchText: "" };
    }

    // 2. Check if there's an active edited cell
    var currentCell = grid.current(); // Might be undefined
    if (!currentCell) {
        console.warn("No active cell being edited");
        return { columnName: "", searchText: "" };
    }

    // 3. Find the closest <td> element (safely)
    var editedCell = $(currentCell).closest("td");
    if (!editedCell.length) {
        console.warn("Edited cell not found");
        return { columnName: "", searchText: "" };
    }

    // 4. Detect ComboBox in the cell
    var comboBox = editedCell.find("[data-role='combobox']").data("kendoComboBox");
    if (comboBox) {
        return {
            columnName: comboBox.element.attr("data-column"),
            searchText: comboBox.input.val() || ""
        };
    }

    // 5. Detect AutoComplete in the cell
    var autoComplete = editedCell.find("[data-role='autocomplete']").data("kendoAutoComplete");
    if (autoComplete) {
        return {
            columnName: autoComplete.element.attr("data-column"),
            searchText: autoComplete.input.val() || ""
        };
    }

    // 6. Fallback
    return { columnName: "", searchText: "" };
}
