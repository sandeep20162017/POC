<!DOCTYPE html>
@{
    string version = "";
    string filePath = "_Version.cshtml";
    if (System.IO.File.Exists(filePath))
    {
        var readText = System.IO.File.ReadAllText(filePath);
        version = readText.Substring(47, 16);
        if (version.Contains("0.0.0.0")) version = "By Label";
    }
    else version = "0.0.0.1";
}
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] â€“ Cost Estimation System</title>
    @using Microsoft.AspNetCore.Hosting
    @inject IWebHostEnvironment HostEnvironment

    <environment names="Development">
        <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
    </environment>
    <environment names="Staging,Production">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
              asp-fallback-href="~/lib/bootstrap/dist/css/bootstrap.min.css"
              asp-fallback-test-class="sr-only" asp-fallback-test-property="position" asp-fallback-test-value="absolute" crossorigin="anonymous" />
    </environment>

    <!-- Theme CSS (dynamically swapped via JS) -->
    <link id="kendo-theme" rel="stylesheet" href="" />

    <link rel="stylesheet" href="~/css/header-footer.css" />
    <link rel="stylesheet" href="~/css/telerik-min.css" />
    <link rel="stylesheet" href="~/css/site.min.css" />

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://kendo.cdn.telerik.com/2021.2.511/js/jszip.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2021.2.511/js/kendo.all.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2021.2.511/js/kendo.aspnetmvc.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
    <script src="@Url.Content("~/js/site.js")"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>

    <script>
        const themeMap = {
            "default": "https://kendo.cdn.telerik.com/themes/11.0.2/default/default-main.css",
            "main-dark": "https://kendo.cdn.telerik.com/themes/11.0.2/default/main-dark.css",
            "nordic": "https://kendo.cdn.telerik.com/themes/11.0.2/default/nordic.css",
            "bootstrap": "https://kendo.cdn.telerik.com/themes/11.0.2/bootstrap/bootstrap-main.css"
        };

        function loadTheme(themeKey) {
            const href = themeMap[themeKey] || themeMap["default"];
            document.getElementById("kendo-theme").href = href;
        }

        $(function () {
            const saved = localStorage.getItem("kendoTheme") || "default";
            $("#themeSelect").val(saved);
            loadTheme(saved);

            $("#themeSelect").change(function () {
                const sel = $(this).val();
                loadTheme(sel);
                localStorage.setItem("kendoTheme", sel);
            });
        });
    </script>
</head>

<body>
    <header>
        <div class="header_container-new d-flex align-items-center">
            <div class="logo">
                <img src="~/images/ttc-main-logo.png" alt="Logo" />
            </div>
            <div class="app-name">
                <h4>Cost Estimate System</h4>
            </div>
            <div class="user-info-new ml-auto d-flex align-items-center">
                <img src="~/images/user.jpg" alt="User" class="user-image" />
                <span class="user-name">| User:</span>
                <span class="user-name ml-1">@ViewBag.UserName |</span>
                <span class="user-name ml-2">Role:</span>
                <span class="user-name ml-1">@ViewBag.RoleName</span>
                <!-- THEME DROPDOWN -->
                <label class="ml-4 mb-0" for="themeSelect">Theme:</label>
                <select id="themeSelect" class="form-control form-control-sm ml-2">
                    <option value="default">Default</option>
                    <option value="main-dark">Main Dark</option>
                    <option value="nordic">Nordic</option>
                    <option value="bootstrap">Bootstrap</option>
                </select>
            </div>
        </div>
    </header>

    <!-- Nav/menu omitted for brevity; keep as in original -->

    <main class="container-fluid">
        @RenderBody()
    </main>

    <footer class="border-top footer text-muted">
        <div class="footer-container d-flex justify-content-between">
            <div>&copy; TTC 2025 - Cost Estimate System | System No.: 0105</div>
            <div>Build Version: @version | Build Date: June 25, 2025</div>
        </div>
    </footer>

    <!-- Session timers and scripts omitted; keep unchanged -->

    @RenderSection("scripts", required: false)
</body>
</html>
