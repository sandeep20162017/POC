@section scripts {
    <script>
        // Populate selected sites when editing a row
        function onSiteChange(e) {
            var selectedSiteIds = this.value(); // Array of selected IDs
            var grid = $("#userGrid").data("kendoGrid");
            var currentRow = $(this.element).closest("tr");
            var dataItem = grid.dataItem(currentRow);

            // Update the data item
            dataItem.set("SiteId", selectedSiteIds);
        }

        // Pre-select site values when editing
        function onEdit(e) {
            if (e.model.SiteId) {
                var siteMultiSelect = e.container.find("[name='SiteId']").data("kendoMultiSelect");
                if (siteMultiSelect) {
                    siteMultiSelect.value(e.model.SiteId); // Set selected IDs
                }
            }
        }
    </script>
}
