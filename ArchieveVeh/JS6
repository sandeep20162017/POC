function onRebuiltStockNumChange(e) {
    var selectedValue = e.sender.value().trim();

    if (selectedValue) {
        var grid = $("#RbPartsMaterialDetailsRebuiltPartsGrid").data("kendoGrid");

        var isDuplicate = false;

        grid.dataSource.data().forEach(function (item) {
            if (item.RebuiltStockNum && item.RebuiltStockNum.trim().toLowerCase() === selectedValue.toLowerCase()) {
                isDuplicate = true;
            }
        });

        if (isDuplicate) {
            kendo.confirm("Rebuilt Part already exists!").then(function () {
                setTimeout(function () {
                    // Force grid to end editing manually
                    var currentUid = grid.select().data("uid"); // find the currently edited row
                    var model = grid.dataSource.getByUid(currentUid);

                    if (model) {
                        grid.closeCell();       // <<< close any open cell
                        grid.cancelRow();       // <<< now cancel row
                    }
                }, 100);
            }, function () {
                setTimeout(function () {
                    var currentUid = grid.select().data("uid");
                    var model = grid.dataSource.getByUid(currentUid);

                    if (model) {
                        grid.closeCell();
                        grid.cancelRow();
                    }
                }, 100);
            });
        }
    }
}
