function onRebuiltStockNumChange(e) {
    var selectedValue = e.sender.value().trim();

    if (selectedValue) {
        var grid = $("#RbPartsMaterialDetailsRebuiltPartsGrid").data("kendoGrid");
        var currentRow = $(e.sender.wrapper).closest("tr"); 
        var currentDataItem = grid.dataItem(currentRow); // Get the model being edited

        var isDuplicate = false;

        grid.dataSource.data().forEach(function (item) {
            if (item.uid !== currentDataItem.uid) { // <<< Ignore current editing row
                if (item.RebuiltStockNum && item.RebuiltStockNum.trim().toLowerCase() === selectedValue.toLowerCase()) {
                    isDuplicate = true;
                }
            }
        });

        if (isDuplicate) {
            kendo.confirm("Rebuilt Part already exists!").then(function () {
                setTimeout(function () {
                    var cell = $(e.sender.wrapper).closest("td");
                    grid.closeCell(cell);
                    grid.cancelChanges();
                }, 100);
            }, function () {
                setTimeout(function () {
                    var cell = $(e.sender.wrapper).closest("td");
                    grid.closeCell(cell);
                    grid.cancelChanges();
                }, 100);
            });
        }
    }
}
