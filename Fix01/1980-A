public async Task<IActionResult> GetMakeVsBuyById(string id, bool readOnly = false)
{
    if (string.IsNullOrEmpty(id))
    {
        // ADD mode
        var vm = new MakeVsBuyViewModel
        {
            MbNumber = null
        };

        return PartialView("~/Views/Shared/_MakeVsBuyPopUp.cshtml", vm);
    }

    // EDIT mode
    const string sql = @"
        SELECT MbNumber, Keyword, Description, BusType, NumBusComp,
               VendorPartNum, BuyCode, RebuildCode, CoreCode, AnnualUsage,
               BenchNumber, SampleProvided, Recommendation
        FROM CES.SBCES.MBLIT   -- ensure correct table name
        WHERE MbNumber = @MbNumber";

    var model = await _dbConnection.QueryFirstOrDefaultAsync<MakeVsBuyViewModel>(
        sql,
        new { MbNumber = id }
    );

    if (model == null)
        return NotFound();

    ViewBag.ReadOnly = readOnly;
    ViewBag.ParentId = id;

    return PartialView("~/Views/Shared/_MakeVsBuyPopUp.cshtml", model);
}
