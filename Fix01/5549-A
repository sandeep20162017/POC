✅ Final working Cancel logic

Here’s the clean version you can drop into your wireVehicleForm():

$("#btnCancelVehicle").off("click").on("click", function () {
    if (pendingChanges) {
        showCloseConfirmation();
    } else {
        var win = $("#estimatePopup").data("kendoWindow");
        win.close();

        // Refresh and focus main grid
        var grid = $("#VehicleGrid").data("kendoGrid");
        if (grid) {
            grid.dataSource.read();
            grid.table.focus();
        }
    }
});

✅ (Optional) — Add a “close” handler directly to popup (for safety)

In your popup init:

$("#estimatePopup").kendoWindow({
    modal: true,
    width: "1100px",
    height: "540px",
    resizable: false,
    scrollable: false,
    title: "Estimate",
    visible: false,
    actions: ["Close"],
    close: function (e) {
        // Refresh main grid every time popup closes
        var grid = $("#VehicleGrid").data("kendoGrid");
        if (grid) {
            grid.dataSource.read();
            grid.refresh();
        }
    }
});


This ensures the grid refreshes even if the user clicks the window’s “X” button instead of the Cancel button.
