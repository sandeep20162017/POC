Add Crystal Report (.rpt) to Project

Right-click project ‚Üí Add ‚Üí Existing Item

Add your YourReport.rpt

Set properties:

Build Action = Content
Copy to Output Directory = Copy if newer

4Ô∏è‚É£ Add Required References

Right-click References ‚Üí Add Reference

Add these (from GAC or Browse):

CrystalDecisions.CrystalReports.Engine
CrystalDecisions.Shared
CrystalDecisions.ReportSource
CrystalDecisions.Web


If they don‚Äôt appear, Crystal Reports for VS is not installed correctly.

5Ô∏è‚É£ Create Web API Controller to Render Report

Create a controller:

Controllers ‚Üí ReportController.cs

‚úÖ Sample Code (PDF Output)
using CrystalDecisions.CrystalReports.Engine;
using CrystalDecisions.Shared;
using System.IO;
using System.Net;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Web.Http;

public class ReportController : ApiController
{
    [HttpGet]
    [Route("api/report/test")]
    public HttpResponseMessage GetReport()
    {
        ReportDocument report = new ReportDocument();

        string reportPath = System.Web.Hosting.HostingEnvironment.MapPath("~/YourReport.rpt");
        report.Load(reportPath);

        // OPTIONAL: Override DB login (recommended for local testing)
        report.SetDatabaseLogon(
            "db_user",
            "db_password",
            "SERVERNAME",
            "DATABASENAME"
        );

        Stream stream = report.ExportToStream(ExportFormatType.PortableDocFormat);
        stream.Seek(0, SeekOrigin.Begin);

        HttpResponseMessage response = new HttpResponseMessage(HttpStatusCode.OK);
        response.Content = new StreamContent(stream);
        response.Content.Headers.ContentType = new MediaTypeHeaderValue("application/pdf");

        return response;
    }
}

6Ô∏è‚É£ Web.config Settings (Mandatory)

Open Web.config and add:

<appSettings>
  <add key="CrystalImageCleaner-Age" value="10" />
  <add key="CrystalImageCleaner-Timeout" value="600" />
</appSettings>

<system.web>
  <compilation debug="true" targetFramework="4.8" />
  <httpRuntime targetFramework="4.8" />
</system.web>

7Ô∏è‚É£ Platform Target (CRITICAL)

Project ‚Üí Properties

Build ‚Üí Platform target:

x64


Disable:

Prefer 32-bit = FALSE


‚ùó Crystal Reports will NOT work in Any CPU

8Ô∏è‚É£ Run & Test Locally
‚ñ∂Ô∏è Run from Visual Studio

Press F5

üåê Test URL in Browser
http://localhost:xxxxx/api/report/test


‚úÖ Expected Result:

Browser downloads or opens PDF report

SQL query inside .rpt executes

Data is shown
