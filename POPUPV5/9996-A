[HttpGet] // Explicitly specify HTTP GET verb
public ActionResult GetVehicleEstimatePopup(int id)
{
    if (id == 0)
    {
        // Create a new vehicle for add mode
        var newVehicle = new VehicleViewModel();
        ViewBag.ParentId = 0;
        ViewBag.FormattedDate = "System Generated";
        return PartialView("_VehEstimatePopUp", newVehicle);
    }
    
    // Get existing vehicle data using Dapper
    var vehicle = _dbConnection.QueryFirstOrDefault<VehicleViewModel>(@"
        SELECT  
            [VehicleListId],
            [VehSeriesCode],
            [NumOfVehicles],
            [ProjDesc],
            [Sopnumber],
            [Make],
            [VehModel],
            [Year],
            [Engine],
            [Transmission],
            [Differential],
            [ModifiedLastBy],
            [ModifiedLastDate]
        FROM [CES].[SBCES].[VehicleList] 
        WHERE VehicleListId = @Id", 
        new { Id = id });

    if (vehicle == null)
    {
        return Content("Vehicle not found");
    }

    ViewBag.ParentId = id;
    ViewBag.FormattedDate = vehicle.ModifiedLastDate == default
        ? "System Generated"
        : vehicle.ModifiedLastDate.ToString("MMM dd, yyyy hh:mm:ss tt");

    return PartialView("_VehEstimatePopUp", vehicle);
}
