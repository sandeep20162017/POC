✅ Updated Refresh Helper

Since these all share the {PartNum} suffix, the safest approach is prefix matching:

function refreshGridByPrefix(prefix) {
    var gridElement = $("[id^='" + prefix + "']");
    if (!gridElement.length) {
        console.warn("No grid element found with prefix:", prefix);
        return;
    }

    var grid = gridElement.data("kendoGrid");
    if (!grid) {
        console.warn("Grid not initialized yet:", gridElement.attr("id"));
        return;
    }

    grid.dataSource.read();
    grid.refresh();
}

✅ TabStrip Integration
$("#estimateTabs").kendoTabStrip({
    activate: function (e) {
        var tabId = $(e.contentElement).attr("id");

        switch (tabId) {
            case "partsSummaryTab":
                refreshGridByPrefix("MaterialCostSummaryInRbViewModelGrid_");
                break;

            case "labourSummaryTab":
                refreshGridByPrefix("LabourDetailsRebuiltPartsViewModelGrid_");
                break;

            case "labourDetailsTab":
                refreshGridByPrefix("LabourDetailsGrid_"); // adjust if exact name differs
                break;

            case "finalEstimateTab":
                refreshGridByPrefix("FinalEstimateGrid_"); // adjust if exact name differs
                break;
        }
    }
});


✅ This way, whichever PartNum is active, the correct grid gets refreshed when switching tabs.
