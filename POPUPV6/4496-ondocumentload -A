$("#estimatePopup").kendoWindow({
    modal: true,
    width: "1100px",
    height: "570px",
    resizable: false,
    scrollable: false,
    title: "Estimate",
    visible: false,
    actions: ["Close"],
    open: function () {
        var ts = $("#estimateTabs").data("kendoTabStrip");
        if (ts) {
            ts.select(0); // ✅ always reset to first tab
        }

        // ✅ Clear previous tab content to avoid stale grids
        $("#vehicleTabContent, #partsTabContent, #labourTabContent, #labourDetailsTabContent, #stockCodedPartsTabContent, #nonStockCodedPartsTabContent, #rebuiltPartsTabContent, #finalEstimateTabContent").empty();

        // ✅ Load vehicle form fresh
        loadVehicleForm(currentVehicleId);
    },
    close: function (e) {
        if (pendingChanges) {
            e.preventDefault();
            showCloseConfirmation();
        }
    }
});
