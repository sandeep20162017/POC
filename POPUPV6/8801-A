function onNscPartsComboBoxSelect(e) {
    // Get the selected item from ComboBox
    var selected = this.dataItem(e.item.index());
    var supplierName = selected ? selected.Text : "";

    // Find the open popup editor window
    var popup = $(".k-window-content:visible");

    // Get the editable model bound to the popup
    var editable = popup.data("kendoEditable");
    var model = editable ? editable.options.model : null;

    // Get supplier number from the popup input field (OrigSuppNum)
    var supplierNumber = $("input[name='OrigSuppNum']").val();

    console.log("**** onNscPartsComboBoxSelect - supplierNumber:", supplierNumber, " supplierName:", supplierName);

    // Update model with supplier name
    if (model && supplierName) {
        model.set("OrigSupplierName", supplierName);
    }

    // Fetch supplier details and update fields in popup
    if (supplierNumber && supplierName) {
        $.ajax({
            url: '/AutoComplete/GetSupplierDetailsByName',
            type: 'GET',
            data: {
                supplierNumber: supplierNumber,
                supplierName: supplierName
            },
            success: function (result) {
                if (result && model) {
                    model.set("OemPartCost", result.PartCost);
                    model.set("Description", result.Description);
                    model.set("KeyWord", result.KeyWord);
                }
            },
            error: function () {
                console.error("Failed to fetch supplier details.");
            }
        });
    }
}
