USE [CES]
GO

BEGIN TRANSACTION;

-- Insert data from [CES].[EMPLOYEE_LABOUR] to [SBCES].[EmployeeLabour]
INSERT INTO [SBCES].[EmployeeLabour] (
    [LabourDefn],
    [DateEntered],
    [LinkNumber],
    [TypeId],
    [CostCentre],
    [Task],
    [LabourType],
    [Usage],
    [HrsReqd],
    [AdjHrs],
    [DateRevised],
    [TimeAddition],
    [RebuiltPartNum],
    [LastModifiedBy]
)
SELECT
    [LABOUR_DEFN],
    [DATE_ENTERED],
    [LINK_NUMBER],
    [TYPEID],
    [COSTCENTRE],
    [TASK],
    CAST([LABOUR_TYPE] AS INT), -- Ensure LabourType is cast to INT
    [USAGE],
    [HRS_REQD],
    [ADJ_HRS],
    [DATE_REVISED],
    [TIME_ADDITION],
    [REBUILT_PART_NUM],
    [LAST_MODIFIED_BY]
FROM [CES].[EMPLOYEE_LABOUR];

-- Check if any rows were inserted
IF @@ROWCOUNT > 0
BEGIN
    PRINT 'Data inserted successfully.';
    COMMIT TRANSACTION;
END
ELSE
BEGIN
    PRINT 'No data was inserted.';
    ROLLBACK TRANSACTION;
END
