BEGIN TRANSACTION;

BEGIN TRY
    -- Step 1: Delete existing data in the target table
    DELETE FROM [SBCES].[EmployeeSalaries];

    -- Step 2: Insert data from the source table
    INSERT INTO [SBCES].[EmployeeSalaries] ([WageGroup], [RatePerHour], [DateEntered])
    SELECT [WageGroup], [RatePerHour], [DateEntered]
    FROM [CES].[EmployeeSalaries];

    -- Commit the transaction if everything is successful
    COMMIT TRANSACTION;
END TRY
BEGIN CATCH
    -- Rollback in case of any error
    ROLLBACK TRANSACTION;
    
    -- Optionally, log the error
    DECLARE @ErrorMessage NVARCHAR(MAX) = ERROR_MESSAGE();
    PRINT 'Error occurred: ' + @ErrorMessage;
END CATCH;
