INSERT INTO SBCES.TempLabourList 
(
    LabourType, 
    Cc, 
    Task, 
    Usage, 
    Time, 
    RatePerHour, 
    TotalCost, 
    ExtendedTime, 
    EstimateType, 
    EstimateNumber, 
    WrenchTime
)
SELECT 
    ELabour.LabourDefn AS LabourType,
    ELabour.CostCentre AS Cc,
    ELabour.Task AS Task,
    REPLACE(ELabour.Usage, ',', '.') AS Usage,
    ELabour.HrsReqd AS Time,
    ESalaries.RatePerHour AS RatePerHour,
    ROUND(
        (SBCES.HhmmToMinutes(ELabour.HrsReqd) * ESalaries.RatePerHour * ELabour.Usage) / 6000,
        2
    ) AS TotalCost,
    ROUND(
        (ELabour.Usage / 100) * SBCES.HhmmToMinutes(ELabour.HrsReqd),
        2
    ) AS ExtendedTime,
    'RB' AS EstimateType,
    UPPER(ELabour.Task) AS EstimateNumber,
    ROUND(
        (ELabour.Usage / 100) * SBCES.HhmmToMinutes(ESalaries.RatePerHour),
        2
    ) AS WrenchTime
FROM 
    SBCES.EmployeeLabour ELabour,
    SBCES.EmployeeSalaries ESalaries,
    SBCES.EmplClass EClass
WHERE 
    ELabour.LabourDefn = UPPER(EClass.LabourDefn) 
    AND ESalaries.WageGroup = EClass.WageGroup 
    AND ELabour.LinkNumber = '035434' 
    AND ELabour.TypeId = 'RB';
